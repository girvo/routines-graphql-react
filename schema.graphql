scalar File
scalar DateTime
scalar NonNegativeInt

directive @skipAuth on FIELD_DEFINITION
directive @authenticated on FIELD_DEFINITION
directive @relay_test_operation on QUERY | MUTATION | SUBSCRIPTION

interface Node {
  id: ID!
}

enum DayOfWeek {
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
  SATURDAY
  SUNDAY
}

enum DaySection {
  MORNING
  MIDDAY
  EVENING
}

type Query {
  node(id: ID!): Node
  me: User!

  # Get today's routine (or specific date)
  dailyRoutine(date: DateTime): DailyRoutinePayload!

  weeklySchedule: WeeklySchedulePayload!
  tasks(first: NonNegativeInt, after: String): TaskConnection!

  taskCompletions(
    first: NonNegativeInt
    after: String
    startDate: DateTime
    endDate: DateTime
  ): TaskCompletionConnection!

  hello: String! @skipAuth
}

type Mutation {
  createTask(title: String!, icon: String): CreateTaskPayload!
  updateTask(input: UpdateTaskInput!): UpdateTaskPayload!
  deleteTask(taskId: ID!): DeleteTaskPayload!

  createRoutineSlot(input: CreateRoutineSlotInput!): CreateRoutineSlotPayload!
  deleteRoutineSlot(routineSlotId: ID!): DeleteRoutineSlotPayload!

  completeRoutineSlot(routineSlotId: ID!): CompleteRoutineSlotPayload!
  uncompleteRoutineSlot(taskCompletionId: ID!): UncompleteRoutineSlotPayload!
}

type User implements Node {
  id: ID!
  email: String!
  createdAt: DateTime!
}

type Task implements Node {
  id: ID!
  title: String!
  icon: String
  createdAt: DateTime!

  slots(first: NonNegativeInt, after: String): RoutineSlotConnection!

  completions(
    first: NonNegativeInt
    after: String
    startDate: DateTime
    endDate: DateTime
  ): TaskCompletionConnection!
}

type RoutineSlot implements Node {
  id: ID!
  task: Task!
  dayOfWeek: DayOfWeek!
  section: DaySection!
  createdAt: DateTime!
}

type TaskCompletion implements Node {
  id: ID!
  routineSlot: RoutineSlot!
  completedAt: DateTime!
}

type DailyRoutinePayload {
  date: DateTime!
  dayOfWeek: DayOfWeek!
  morning(first: NonNegativeInt, after: String): DailyTaskInstanceConnection!
  midday(first: NonNegativeInt, after: String): DailyTaskInstanceConnection!
  evening(first: NonNegativeInt, after: String): DailyTaskInstanceConnection!
}

type DailyTaskInstance {
  routineSlot: RoutineSlot!
  completion: TaskCompletion
}

type WeeklySchedulePayload {
  monday: DaySchedule!
  tuesday: DaySchedule!
  wednesday: DaySchedule!
  thursday: DaySchedule!
  friday: DaySchedule!
  saturday: DaySchedule!
  sunday: DaySchedule!
}

type DaySchedule {
  dayOfWeek: DayOfWeek!
  morning(first: NonNegativeInt, after: String): RoutineSlotConnection!
  midday(first: NonNegativeInt, after: String): RoutineSlotConnection!
  evening(first: NonNegativeInt, after: String): RoutineSlotConnection!
}

type TaskConnection {
  edges: [TaskEdge!]!
  pageInfo: PageInfo!
}

type TaskEdge {
  node: Task!
  cursor: String!
}

type RoutineSlotConnection {
  edges: [RoutineSlotEdge!]!
  pageInfo: PageInfo!
}

type RoutineSlotEdge {
  node: RoutineSlot!
  cursor: String!
}

type TaskCompletionConnection {
  edges: [TaskCompletionEdge!]!
  pageInfo: PageInfo!
}

type TaskCompletionEdge {
  node: TaskCompletion!
  cursor: String!
}

type DailyTaskInstanceConnection {
  edges: [DailyTaskInstanceEdge!]!
  pageInfo: PageInfo!
}

type DailyTaskInstanceEdge {
  node: DailyTaskInstance!
  cursor: String!
}

type PageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
  endCursor: String
}

input UpdateTaskInput {
  taskId: ID!
  title: String
  icon: String
}

input CreateRoutineSlotInput {
  taskId: ID!
  dayOfWeek: DayOfWeek!
  section: DaySection!
}

type CreateTaskPayload {
  taskEdge: TaskEdge!
}

type UpdateTaskPayload {
  task: Task!
}

type DeleteTaskPayload {
  deletedId: ID!
}

type CreateRoutineSlotPayload {
  routineSlotEdge: RoutineSlotEdge!
}

type DeleteRoutineSlotPayload {
  deletedId: ID!
}

type CompleteRoutineSlotPayload {
  taskCompletionEdge: TaskCompletionEdge!
}

type UncompleteRoutineSlotPayload {
  deletedId: ID!
}
